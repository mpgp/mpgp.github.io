sudo: required
language: node_js
node_js:
  - stable
addons:
  chrome: stable
cache:
  directories:
    - node_modules
branches:
  only:
    - src

before_install:
  - sudo chown root /opt/google/chrome/chrome-sandbox
  - sudo chmod 4755 /opt/google/chrome/chrome-sandbox
  - export CHROME_BIN=chromium-browser
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
install:
  - cd spec
  - npm i
  - npm i coveralls
  - cd ..
before_script:
  - cd spec
  - npm run lint
  - npm run build
  - cd ..
script:
  - cd spec
  - npm run travis:e2e
  - npm run travis:test
# coveralls.io
  - cat ./coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js
  - cd ..
after_success:
  - cd spec
  # - https://circleci.com/
  - cd ..
  # - sync with bitbucket/gitlab

deploy:
  provider: pages
  skip_cleanup: true
  # https://github.com/settings/tokens
  github_token: $GITHUB_TOKEN
  local_dir: dist
  target-branch: master
  email: torvalds@linux-foundation.org
  name: Linus Torvalds
  on:
    branch: "src"
